.. _zend.console.getopt.rules:

Getopt の規則の宣言
=============

``Zend_Console_Getopt`` クラスのコンストラクタは、
ひとつから三つの引数を指定します。最初の引数では、
このアプリケーションでサポートするオプションを宣言します。
このクラスは、オプションを宣言するためのもうひとつの構文もサポートしています。
以下の節で、これらの構文についての書式や使用法を参照ください。

コンストラクタには、さらに二つの引数を指定します。
これらはオプションです。二番目の引数に指定するのは
コマンドライン引数です。デフォルトは ``$_SERVER['argv']`` となります。

コンストラクタの三番目の引数には、設定オプションを指定します。 これで
``Zend_Console_Getopt`` の振る舞いを変更します。 使用可能なオプションについては
:ref:`設定の追加 <zend.console.getopt.configuration.config>` を参照ください。

.. _zend.console.getopt.rules.short:

短い形式のオプションの宣言
-------------

``Zend_Console_Getopt`` は、 *GNU* Getopt
と似た形式のコンパクトな構文をサポートしています
(`http://www.gnu.org/software/libc/manual/html_node/Getopt.html`_ を参照ください)。
この構文は、一文字のフラグでのみ使用できます。
アプリケーションでサポートするフラグに対応する文字を、
ひとつの文字列にまとめてで指定します。 文字の後ろにコロン (**:**) を続けると、
そのフラグがパラメータを要求することを表します。

.. _zend.console.getopt.rules.short.example:

.. rubric:: 短い形式の構文の使用

.. code-block:: php
   :linenos:

   $opts = new Zend_Console_Getopt('abp:');

上の例は、 ``Zend_Console_Getopt`` を用いて、 使用するオプションを ``-a`` や ``-b``
あるいは ``-p`` と宣言するものです。
最後のフラグにはパラメータが必要となります。

短い構文が使用できるのは、一文字のフラグに限られます。
エイリアスやパラメータ型、ヘルプ文字列は短い構文ではサポートしません。

.. _zend.console.getopt.rules.long:

長い形式のオプションの宣言
-------------

より高機能な別の構文もサポートしています。この構文では、
フラグにエイリアスを設定したりオプションパラメータの型を指定したり、
ユーザに対して使用法を示すヘルプ文字列を指定したりもできます。
短い構文のオプションを宣言する場合には文字列を使用しましたが、
長い構文の場合は連想配列を使用します。
これをコンストラクタの最初の引数として指定します。

連想配列の各要素のキーは、フラグの名前とエイリアスをパイプ記号 ("**|**")
で連結した文字列となります。 そのオプションがパラメータを必要とする場合は、
フラグに続けて等号 ("**=**") を書き、
その後にパラメータの型を表す文字を続けます。

- "**=s**" は文字列パラメータを表します。

- "**=w**" はワードパラメータ (空白を含まない文字列) を表します。

- "**=i**" は整数パラメータを表します。

そのパラメータがオプションである場合は、等号の代わりにダッシュ ("**-**")
を使用します。

連想配列の各要素の値は、ヘルプ文字列を表します。これは、
ユーザに対してプログラムの使用法を説明するものです。

.. _zend.console.getopt.rules.long.example:

.. rubric:: 長い形式の構文の使用

.. code-block:: php
   :linenos:

   $opts = new Zend_Console_Getopt(
     array(
       'apple|a'    => 'リンゴです。パラメータは不要です。',
       'banana|b=i' => 'バナナです。整数パラメータが必須です。',
       'pear|p-s'   => '洋ナシです。オプションで文字列パラメータを指定します。'
     )
   );

上の例では、三種類のオプションを宣言しています。 ``--apple`` および ``-a``
は同じ意味を持つエイリアスで、 このオプションはパラメータを受け取りません。
``--banana`` および ``-b`` は同じ意味を持つエイリアスで、
このオプションには整数値のパラメータが必須となります。 最後に ``--pear`` および
``-p`` は同じ意味を持つエイリアスで、
このオプションには任意で文字列のパラメータを指定できます。



.. _`http://www.gnu.org/software/libc/manual/html_node/Getopt.html`: http://www.gnu.org/software/libc/manual/html_node/Getopt.html
